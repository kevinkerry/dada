!function(){function e(e){if(!(i&&a>i)){h.style.opacity=1;var n=ctx+"/user/queryPage?currentPage="+a++;e&&(n+="&keyword="+e);var r=new XMLHttpRequest;r.open("GET",n),r.onload=function(){var e=JSON.parse(r.responseText),n=e.result;i=e.totalPages,t(n),h.style.opacity=0},r.send()}}function t(t){for(var i=0,a=t.length;a>i;i++){var c=t[i],h=r(c),v=[];v.push('<img class="user-img"'),c.height&&v.push(' style="height:"'+c.height+'px;"'),v.push(' src="'+ctx+'/resources/images/loading.gif" lazy-src="http://image.dadasports.cn'+h+'" alt="哒人图片">'),v.push('<div class="user-info"><span class="user-id">ID:'+c.id+"</span>"+c.username+"</div>");var f=document.createElement("li");f.classList.add("item"),f.setAttribute("data-id",c.id),f.innerHTML=v.join(""),f.addEventListener("click",function(){location.href=ctx+"/user/"+this.getAttribute("data-id")+"/detail"}),s>=o?(u.appendChild(f),o+=c.newHeight+30):(d.appendChild(f),s+=c.newHeight+30)}l=document.querySelectorAll(".u-user-container .user-img"),l[l.length-1].addEventListener("load",function(){this.getAttribute("loaded")&&e(p?g.value:null)}),n()}function n(){for(var e=window.innerHeight+document.body.scrollTop,t=0,n=l.length;n>t;t++){var r=l[t];!r.getAttribute("loaded")&&r.offsetTop<e&&(r.setAttribute("src",r.getAttribute("lazy-src")),r.setAttribute("loaded","true"))}}function r(e){if(!e.images[0].imageUrl)return"";var t=e.images[0].imageUrl,n=t.split("!");if(n.length>1){var r=n[1].split("."),i=r[0],a="";r.length>1&&(a=r[1]);var o=i.split("x");if(o.length>1){var s=o[0],u=o[1],d=parseInt(.5*window.innerWidth),l=parseInt(d*u/s);return e.newHeight=d*u/s,e.height=l,e.width=d,n[0]+"!"+d+"x"+l+"."+a}return n[0]+o[0]+a?"."+a:""}return t}var i,a=1,o=0,s=0,u=document.querySelector("#userList1"),d=document.querySelector("#userList2"),l=[],c=0,g=document.querySelector("#searchInput"),h=document.querySelector("#loading"),p=!1;document.querySelector("#addBtn").addEventListener("click",function(){location.href=ctx+"/user/add"}),document.querySelector("#btnSearch").addEventListener("click",function(){return 0==g.value.length?void swal("请输入要搜索的ID或名字"):(a=1,u.innerHTML="",d.innerHTML="",o=0,s=0,p=!0,void e(g.value))}),e(),window.addEventListener("scroll",function(){document.body.scrollTop-c>10&&n(),c=document.body.scrollTop})}();